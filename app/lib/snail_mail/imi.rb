module SnailMail
  class IMI
    class << self
      include SnailMail::Helpers

      def render_indicium(pdf, letter, indicium, x = bounds.width - 294, options = {})
        svg = Nokogiri::XML(indicium&.svg || (raise "no indicium?"))
        imi_el = svg % "image#imi-barcode"
        raise "no imi element?" unless imi_el.present?
        imi_href = imi_el["xlink:href"]
        raise "no IMI href???" unless imi_href.present?
        imi_png = Base64.decode64(imi_href.split(",", 2).last)
        raise "failed to decode imi png -_-" unless imi_png.present?
        pdf.image(
          StringIO.new(imi_png),
          at: [x + 79, pdf.bounds.top - 8],
          width: 51,
        )
        pdf.bounding_box([x, pdf.bounds.top - 11], width: 90, height: 45) do
          pdf.font_size(8)
          pdf.text("U.S. POSTAGE", style: :bold)
          pdf.text(letter.mailing_date.strftime("%m/%d/%Y")) unless options[:no_indicia_date]
          pdf.text(ActiveSupport::NumberHelper.number_to_currency(indicium.cost))
          pdf.text("LFP", style: :bold)
          pdf.font("f25") { pdf.text("#{Rails.env.production? ? "hackapost" : "DEV"}!/#{indicium.hashid}", size: 6.2) }
        end

        pdf.image(StringIO.new(WATERMARK), at: [x, pdf.bounds.top - 5], width: 121) if (wm = svg % "#watermark") && wm["visibility"] != "hidden"
      rescue StandardError => e
        render_no_indicium(pdf, letter, e.class == StandardError ? e.message : "#{e.class}: #{e.message}")
      end

      private

      def render_no_indicium(pdf, letter, reason)
        error_text = <<~EOT
          this shouldn't happen.
          please tell nora about #{letter.public_id} and #{letter.usps_indicium&.public_id || "nonexistent indicium!"} :-(
          "#{reason}"
        EOT

        pdf.image(
          image_path("no_indicium.png"),
          width: 144,
          at: [432 - 144, 288],
        )
        pdf.text_box(error_text, at: [256, 280], width: 90, height: 65, overflow: :shrink_to_fit, size: 8)
      end

      WATERMARK = Base64.decode64 <<~EOI
                                    iVBORw0KGgoAAAANSUhEUgAAAfQAAADiCAQAAAASJ/0zAAADE2lDQ1BEb3QgR2FpbiAyMCUAACiRY2BgnuDo4uTKJMDAUFBUUuQe5BgZERmlwH6egY2BmYGBgYGBITG5uMAxIMCHgYGBIS8/L5UBFTAyMHy7xsDIwMDAcFnX0cXJlYE0wJpcUFTCwMBwgIGBwSgltTiZgYHhCwMDQ3p5SUEJAwNjDAMDg0hSdkEJAwNjAQMDg0h2SJAzAwNjCwMDE09JakUJAwMDg3N+QWVRZnpGiYKhpaWlgmNKflKqQnBlcUlqbrGCZ15yflFBflFiSWoKAwMD1A4GBgYGXpf8EgX3xMw8BSMDVRLdTRBEREYpQFiI8EGIIUByaVEZhMXIwMDAIMCgwGDA4MAQwJDIUM+wgOEowxtGcUYXxlLGFYz3mMSYgpgmMF1gFmaOZF7I/IbFkqWD5RarHmsr6z02S7ZpbN/Yw9l3cyhxdHF84UzkvMDlyLWFW5N7AY8Uz1ReId5JfMJ80/hl+BcL6AjsEHQVvCKUKvRDuFdERWSvaLjoF7FJ4kbiVyQqJOUkj0nlS0tLn5Apk1WXvSXXJ+8i/0dhq2Khkp7SW+W1KgWqJqo/1Q6qd2mEaippftA6oD1JJ1XXSk9Q75X+EYMFhrVGMca2JvKmzKYvzS6Y77RYYjnBqs461ybONtDO1d7awdhRx0nNWclFwVXeTcFd2UPdU9fLxNvGx9032C/BPz+gPnBi0NLgXSEXQ1+GM0XIRVpFRURXxMyM3RP3IIEtUTcpLLkhZU3qzXSODIvMzKy52Rdz2fPs8ysKNhW+K9YuySpdVfamQr+ypGpXDWOtV93U+oeNek01zWdb5doK2492SncVdZ/uVe1r7L870WbS7Ml/p8ZPOzxDY2b/rO9zEuaenm++YOkikcWtS74ty1x+b2XIqtNrXNbuW2+5Ydsmk81btpps277Dauf+3a57zu4L2//gYM6hn0faj4kfX3HS+tS5M8lnf52fdFH70tEriVf/XZ9z0+bW3Tv195Tvn3iY91jsyf5nmS9EXh58nf9W/t2FD02fTD+/+rrge/hPgV+n/rT+c/z/HwANAA803sW02gAAAAlwSFlzAAAOxAAADsQBlSsOGwAABwdpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmExY2QxMmY0MSwgMjAyNC8xMS8wOC0xNjowOToyMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMSIgcGhvdG9zaG9wOkRhdGVDcmVhdGVkPSIyMDI1LTA0LTA3VDE1OjU5OjAzLTA0OjAwIiB4bXA6Q3JlYXRlRGF0ZT0iMjAyNS0wNC0wN1QxNTo1OTowMy0wNDowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyNS0wNC0wN1QxNjowNToyNi0wNDowMCIgeG1wOk1vZGlmeURhdGU9IjIwMjUtMDQtMDdUMTY6MDU6MjYtMDQ6MDAiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MGQ5N2ViMTAtZTg2MC00ODQ5LThlZGUtMTY2MTkwNjU3MDRiIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjBkOTdlYjEwLWU4NjAtNDg0OS04ZWRlLTE2NjE5MDY1NzA0YiIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjBkOTdlYjEwLWU4NjAtNDg0OS04ZWRlLTE2NjE5MDY1NzA0YiIgdGlmZjpJbWFnZVdpZHRoPSI1MDAiIHRpZmY6SW1hZ2VMZW5ndGg9IjIyNiIgdGlmZjpYUmVzb2x1dGlvbj0iOTYvMSIgdGlmZjpZUmVzb2x1dGlvbj0iOTYvMSIgdGlmZjpSZXNvbHV0aW9uVW5pdD0iMiIgZXhpZjpDb2xvclNwYWNlPSIxIiBleGlmOlBpeGVsWERpbWVuc2lvbj0iNTAwIiBleGlmOlBpeGVsWURpbWVuc2lvbj0iMjI2IiBkYzpmb3JtYXQ9ImltYWdlL3BuZyI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSB4bXBNTTphY3Rpb249InByb2R1Y2VkIiB4bXBNTTpzb2Z0d2FyZUFnZW50PSJBZmZpbml0eSBEZXNpZ25lciAyIDIuNC4wIiB4bXBNTTp3aGVuPSIyMDI1LTA0LTA3VDE1OjU5OjUwLTA0OjAwIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJwcm9kdWNlZCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWZmaW5pdHkgUGhvdG8gMiAyLjEuMSIgc3RFdnQ6d2hlbj0iMjAyNS0wNC0wN1QxNjowMTo1Ny0wNDowMCIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6MGQ5N2ViMTAtZTg2MC00ODQ5LThlZGUtMTY2MTkwNjU3MDRiIiBzdEV2dDp3aGVuPSIyMDI1LTA0LTA3VDE2OjA1OjI2LTA0OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjYuMiAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4Kb33YAAArvUlEQVR4nO1d7Zasqg7Uu877v7L3x0y3kFSSSkDbnk2d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
                                  EOI
    end
  end
end
